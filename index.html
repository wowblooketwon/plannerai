<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lil Scoom GPT-2 Chatbot</title>
<style>
  body {
    background: #000;
    color: #0ff;
    font-family: monospace;
    padding: 20px;
    max-width: 600px;
    margin: auto;
  }
  #chat {
    height: 400px;
    overflow-y: auto;
    border: 1px solid #0ff;
    padding: 10px;
    margin-bottom: 10px;
    background: #111;
  }
  .msg {
    margin: 8px 0;
  }
  .user {
    color: #0f0;
  }
  .bot {
    color: #0ff;
  }
  input, button {
    padding: 10px;
    font-size: 16px;
    border-radius: 6px;
    border: none;
    outline: none;
  }
  input {
    width: 80%;
    margin-right: 10px;
    background: #222;
    color: #0ff;
  }
  button {
    background: #0ff;
    color: #000;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>Lil Scoom GPT-2 Chatbot</h1>
<div id="chat"></div>
<input id="input" placeholder="Type your message..." />
<button id="sendBtn">Send</button>

<script src="https://cdn.jsdelivr.net/npm/@xtekky/gpt2-tfjs@latest/dist/gpt2.min.js"></script>
<script>
  const chat = document.getElementById('chat');
  const input = document.getElementById('input');
  const sendBtn = document.getElementById('sendBtn');

  // Create GPT2 instance
  const gpt2 = new GPT2();

  async function loadModel() {
    await gpt2.loadModel();
    addMessage('bot', "Wsg bru I'm Lil Scoom ðŸ˜¤ Ask me sum");
  }

  loadModel();

  function addMessage(cls, text) {
    const div = document.createElement('div');
    div.className = 'msg ' + cls;
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }

  sendBtn.onclick = async () => {
    const text = input.value.trim();
    if (!text) return;
    addMessage('user', text);
    input.value = '';
    addMessage('bot', 'Scoom thinking...');

    // Remove the "Scoom thinking..." message before response
    const thinkingMsg = chat.querySelector('.msg.bot:last-child');

    try {
      const output = await gpt2.generate(text, {
        length: 50,
        temperature: 0.7,
        top_k: 40,
      });
      thinkingMsg.remove();
      addMessage('bot', output);
    } catch (e) {
      thinkingMsg.remove();
      addMessage('bot', 'Scoom messed up ðŸ˜¢');
      console.error(e);
    }
  };
</script>

</body>
</html>
